name: 7z

on: page_build

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
        with:
          python-version: 3.7
      - name: install requirements
        run: |
          python -m pip install --upgrade pip
          pip install -U -r requirements.txt
          sudo apt-get install p7zip
      - name: 7z compress
        run: |
          7z a -t7z ./Main.7z ./Main/* -mx=9
      - name: 7z push
        run: |
          python push.py ${{ secrets.YLOGIN }} ${{ secrets.PHPDISK_INFO }} ${{ secrets.SERVERCHAN }}
